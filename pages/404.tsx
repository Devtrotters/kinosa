import { ApolloClient, createHttpLink, gql, InMemoryCache } from '@apollo/client';
import { setContext } from '@apollo/client/link/context';
import DefaultLayout from 'components/layouts/default';
import router, { useRouter } from 'next/router';
import React from 'react';
import { NotFoundContainer, NotFoundText, NotFoundTitle } from 'styles/404';
import { Title } from 'styles/UI/Texts.style';

export default function NotFound({ data }) {
    const footerData = {
        feed: data.instagram,
        newsletter: data.newsletter,
        social: data.footerSocial
    };

    const styles = {
        display: 'flex',
        flexDirection: 'column'
    };

    const router = useRouter();

    return (
        <DefaultLayout
            _site={data._site}
            seo={data.seoContact}
            pages={data.page.pages}
            footer={footerData}>
            <NotFoundContainer>
                <svg
                    width="412"
                    height="268"
                    viewBox="0 0 412 268"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M279.734 0H193.415C192.12 0 190.938 0.506936 190.037 1.40815L132.941 58.7482C132.04 59.6494 131.534 60.8886 131.534 62.1278V200.803C131.534 203.45 133.673 205.591 136.32 205.591H279.734C282.381 205.591 284.52 203.45 284.52 200.803V4.78773C284.52 2.1404 282.381 0 279.734 0ZM279.734 200.803H136.32V62.1278L193.415 4.78773H279.734V200.803Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M186.658 99.5845C187.109 100.035 187.728 100.26 188.348 100.26C188.967 100.26 189.586 100.035 190.037 99.5845C190.994 98.627 190.994 97.1062 190.037 96.205L177.255 83.4189L190.037 70.6329C190.994 69.6753 190.994 68.1545 190.037 67.2533C189.08 66.2958 187.559 66.2958 186.658 67.2533L173.877 80.0394L162.165 68.3235C161.207 67.366 159.687 67.366 158.786 68.3235C157.829 69.2811 157.829 70.8019 158.786 71.7031L170.498 83.4189L158.786 95.1348C157.829 96.0923 157.829 97.6131 158.786 98.5143C159.237 98.965 159.856 99.1903 160.475 99.1903C161.095 99.1903 161.714 98.965 162.165 98.5143L173.877 86.7985L186.658 99.5845Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M227.369 98.5143C227.819 98.965 228.439 99.1903 229.058 99.1903C229.677 99.1903 230.297 98.965 230.747 98.5143L242.459 86.7985L255.241 99.5845C255.691 100.035 256.311 100.26 256.93 100.26C257.549 100.26 258.169 100.035 258.619 99.5845C259.576 98.627 259.576 97.1062 258.619 96.205L245.838 83.4189L258.619 70.6329C259.576 69.6753 259.576 68.1545 258.619 67.2533C257.662 66.2958 256.142 66.2958 255.241 67.2533L242.459 80.0394L230.747 68.3235C229.79 67.366 228.27 67.366 227.369 68.3235C226.412 69.2811 226.412 70.8019 227.369 71.7031L239.081 83.4189L227.369 95.1348C226.412 96.0923 226.412 97.6131 227.369 98.5143Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M170.386 149.264C163.967 157.206 162.39 165.148 162.334 165.486C162.108 166.782 162.953 168.021 164.248 168.302C165.543 168.528 166.782 167.683 167.064 166.387C167.064 166.331 168.527 159.178 174.271 152.137C181.929 142.787 193.303 138.055 208.055 138.055C222.864 138.055 234.857 142.843 243.641 152.25C250.229 159.347 252.482 166.556 252.538 166.613C252.876 167.627 253.777 168.302 254.846 168.302C255.072 168.302 255.297 168.246 255.522 168.19C256.761 167.796 257.493 166.5 257.099 165.205C256.986 164.867 254.565 157.037 247.301 149.152C240.601 141.885 228.382 133.268 208.055 133.268C187.616 133.268 176.298 141.998 170.386 149.264Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M102.254 137.154H82.0396V24.2764H76.9157H72.6363H71.0034L0 138.393V146.054H72.6363V181.314H81.9833V146.054H102.198V137.154H102.254ZM11.5993 136.309L71.9043 39.0902H72.6926V137.154H11.5993V136.309Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M412 137.154H391.786V24.2764H386.662H382.439H380.806L309.746 138.393V146.054H382.382V181.314H391.729V146.054H411.944V137.154H412ZM321.289 136.309L381.65 39.0902H382.439V137.154H321.289V136.309Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M140.149 252.792H154.845V250.144H140.149V238.034H155.858V235.387H137.221V267.549H156.14V264.902H140.149V252.792Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M179.563 253.355C181.084 252.566 182.266 251.44 182.998 249.975C183.787 248.567 184.181 246.877 184.181 245.019C184.181 243.16 183.787 241.47 182.998 240.006C182.21 238.541 181.084 237.415 179.507 236.57C177.987 235.725 176.072 235.331 173.764 235.331H163.403V267.549H166.331V254.538H173.82C174.271 254.538 174.665 254.538 175.059 254.481L182.097 267.549H185.476L178.043 253.918C178.606 253.806 179.113 253.58 179.563 253.355ZM173.764 251.89H166.331V238.034H173.708C175.397 238.034 176.804 238.316 177.931 238.879C179.057 239.442 179.901 240.287 180.408 241.301C180.971 242.371 181.253 243.554 181.253 244.962C181.253 246.371 180.971 247.553 180.408 248.624C179.845 249.637 179 250.426 177.931 250.989C176.861 251.609 175.453 251.89 173.764 251.89Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M207.436 253.355C208.956 252.566 210.139 251.44 210.871 249.975C211.659 248.567 212.053 246.877 212.053 245.019C212.053 243.16 211.659 241.47 210.871 240.006C210.083 238.541 208.956 237.415 207.38 236.57C205.859 235.725 203.945 235.331 201.636 235.331H191.276V267.549H194.204V254.538H201.693C202.143 254.538 202.537 254.538 202.931 254.481L210.026 267.549H213.405L205.972 253.918C206.535 253.806 206.986 253.58 207.436 253.355ZM201.693 251.89H194.26V238.034H201.636C203.326 238.034 204.733 238.316 205.859 238.879C206.986 239.442 207.83 240.287 208.337 241.301C208.9 242.371 209.182 243.554 209.182 244.962C209.182 246.371 208.9 247.553 208.337 248.624C207.774 249.637 206.929 250.426 205.859 250.989C204.733 251.609 203.326 251.89 201.693 251.89Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M238.855 237.02C236.772 235.669 234.351 234.993 231.648 234.993C228.945 234.993 226.524 235.669 224.441 237.02C222.357 238.372 220.725 240.287 219.542 242.766C218.36 245.244 217.74 248.173 217.74 251.496C217.74 254.819 218.36 257.748 219.542 260.227C220.725 262.705 222.357 264.62 224.441 265.972C226.524 267.324 228.945 268 231.648 268C234.351 268 236.772 267.324 238.855 265.972C240.939 264.62 242.572 262.705 243.754 260.227C244.937 257.748 245.556 254.819 245.556 251.496C245.556 248.173 244.937 245.244 243.754 242.766C242.628 240.287 240.995 238.372 238.855 237.02ZM241.333 258.875C240.376 260.959 239.081 262.48 237.391 263.606C235.702 264.677 233.844 265.24 231.704 265.24C229.565 265.24 227.707 264.677 226.017 263.606C224.328 262.536 223.033 260.959 222.076 258.875C221.119 256.847 220.612 254.369 220.612 251.496C220.612 248.624 221.119 246.145 222.076 244.061C223.033 242.033 224.384 240.456 226.017 239.33C227.707 238.26 229.565 237.696 231.648 237.696C233.788 237.696 235.646 238.26 237.335 239.33C239.024 240.4 240.319 241.977 241.277 244.061C242.234 246.145 242.741 248.567 242.741 251.44C242.741 254.369 242.29 256.847 241.333 258.875Z"
                        fill="#007A0C"
                    />
                    <path
                        d="M274.779 267.549L267.347 253.918C267.853 253.749 268.36 253.58 268.811 253.299C270.331 252.51 271.513 251.384 272.245 249.919C273.034 248.511 273.428 246.821 273.428 244.963C273.428 243.104 273.034 241.414 272.245 239.949C271.457 238.485 270.331 237.358 268.754 236.514C267.234 235.669 265.32 235.274 263.011 235.274H252.65V267.549H255.578V254.538H263.067C263.518 254.538 263.912 254.538 264.306 254.482L271.401 267.549H274.779ZM263.011 251.891H255.635V238.034H263.011C264.7 238.034 266.108 238.316 267.234 238.879C268.36 239.443 269.205 240.287 269.711 241.301C270.275 242.372 270.556 243.554 270.556 244.963C270.556 246.371 270.275 247.554 269.711 248.624C269.148 249.638 268.304 250.426 267.234 250.989C266.108 251.609 264.7 251.891 263.011 251.891Z"
                        fill="#007A0C"
                    />
                </svg>
                <NotFoundTitle>Page non trouvée</NotFoundTitle>
                <NotFoundText>
                    Désolé nous ne trouvons pas la page : kinosa.fr{router.asPath}
                </NotFoundText>
                <NotFoundText>
                    Essayez cette recherche :{' '}
                    <a href="https://www.kinosa.fr/">https://www.kinosa.fr/</a>{' '}
                </NotFoundText>
            </NotFoundContainer>
        </DefaultLayout>
    );
}

export async function getStaticProps() {
    const httpLink = createHttpLink({
        uri: `https://graphql.datocms.com/`
    });

    const authLink = setContext((_, { headers }) => {
        return {
            headers: {
                ...headers,
                authorization: `Bearer ${process.env.NEXT_DATOCMS_API_TOKEN}`
            }
        };
    });

    const client = new ApolloClient({
        link: authLink.concat(httpLink),
        cache: new InMemoryCache()
    });

    const { data } = await client.query({
        query: gql`
            query {
                _site {
                    favicon: faviconMetaTags {
                        attributes
                        content
                        tag
                    }
                }
                seoContact {
                    data: _seoMetaTags {
                        attributes
                        content
                        tag
                    }
                }
                page {
                    pages {
                        id
                        slug
                        titre
                    }
                }
                contact {
                    titre
                    texte {
                        id
                        texte
                    }
                    image {
                        url
                        alt
                    }
                }
                instagram {
                    titre
                    texteLien
                    lien
                    image {
                        id
                        lien
                        alt
                    }
                }
                newsletter {
                    titre
                    texte
                    bouton
                }
                footerSocial {
                    titre
                    social {
                        id
                        nom
                        lien
                    }
                }
            }
        `
    });

    return {
        props: { data }
    };
}
